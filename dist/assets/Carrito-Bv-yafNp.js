import{u,a as g,r as p,j as e}from"./index-CmXrzbuy.js";import{u as v}from"./useCarrito-RxCCMsFo.js";import{f as N}from"./fetchData-BWBJaPpc.js";const C=N("http://localhost:8080/api/metodosEntrega/listar");function y(){const{carrito:n,eliminarDelCarrito:l,actualizarCantidad:d,totalCarrito:c,stockMap:o}=v(),{cliente:x}=u(),h=g(),t=C.read(),[r,j]=p.useState(null),m=a=>{const s=t.find(i=>i.nombre===a.target.value);j(s)},b=()=>{if(!x){alert("Debes iniciar sesión para realizar una compra."),h("/login");return}if(!r){alert("Debes seleccionar un método de entrega antes de comprar.");return}alert("Procediendo con la compra...")};return e.jsxs("div",{children:[e.jsxs("div",{className:"banner",children:[e.jsx("img",{src:"/images/banner-carrito.jpg",className:"banner-image",alt:"Banner"}),e.jsx("div",{className:"texto1",children:"Mi carrito"})]}),e.jsx("div",{className:"contenido-carrito",children:n.length===0?e.jsx("p",{children:"Tu carrito está vacío."}):e.jsxs("div",{className:"carrito-layout",children:[e.jsxs("table",{className:"tabla-carrito",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Producto"}),e.jsx("th",{children:"Cantidad"}),e.jsx("th",{children:"Precio"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:n.map(a=>e.jsxs("tr",{children:[e.jsx("td",{"data-label":"Producto",children:e.jsxs("div",{className:"producto-info",children:[e.jsx("img",{src:`/images/${a.imagen}`,alt:a.nombre,className:"producto-imagen-carrito"}),e.jsxs("div",{className:"producto-detalle-carrito",children:[e.jsx("strong",{children:a.nombre}),e.jsx("p",{children:a.descripcion})]})]})}),e.jsx("td",{"data-label":"Cantidad",children:e.jsx("input",{type:"number",value:a.cantidad,min:"0",max:o[a.idProducto]||99,onChange:s=>{const i=s.target.value;d(a.idProducto,Number(i))}})}),e.jsxs("td",{"data-label":"Precio",children:["S/. ",(a.precio*a.cantidad).toFixed(2)]}),e.jsx("td",{"data-label":"Eliminar",children:e.jsx("div",{className:"boton-eliminar",onClick:()=>l(a.idProducto),children:"🗑️"})})]},a.idProducto))})]}),e.jsxs("table",{className:"tabla-total",children:[e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:"Subtotal:"})}),e.jsx("td",{children:e.jsxs("strong",{children:["S/. ",c.toFixed(2)]})})]}),e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsx("div",{children:e.jsx("strong",{children:"Método de entrega:"})}),t==null?void 0:t.map((a,s)=>e.jsxs("label",{style:{display:"block",cursor:"pointer"},children:[e.jsx("input",{type:"radio",name:"metodoEntrega",value:a.nombre,onChange:m,checked:(r==null?void 0:r.nombre)===a.nombre}),a.nombre]},s))]}),e.jsx("td",{children:r?e.jsxs("strong",{children:["S/. ",r.costo.toFixed(2)]}):e.jsx("p",{children:"Pendiente"})})]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:"Total:"})}),e.jsx("td",{children:e.jsxs("strong",{children:["S/. ",(c+(r?Number(r.costo):0)).toFixed(2)]})})]})]}),e.jsx("tfoot",{children:e.jsx("tr",{children:e.jsx("td",{colSpan:"2",className:"td-comprar",children:e.jsx("button",{className:"btn-comprar",onClick:b,children:"🔒︎ Comprar"})})})})]})]})})]})}export{y as default};
